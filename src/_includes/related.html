<section class="related">
  <section class="book-holder">
    {% assign maxRelated = 3 %}
    {% assign minCommonTags =  1 %}
    {% assign maxRelatedCounter = 0 %}
    {% for post in site.posts %}
      {% assign sameTagCount = 0 %}
      {% assign commonTags = '' %}
      {% for tag in post.tags %}
        {% if post.url != page.url %}
          {% if page.tags contains tag %}
            {% assign sameTagCount = sameTagCount | plus: 1 %}
            {% assign commonTags = commonTags %}
          {% endif %}
        {% endif %}
      {% endfor %}
      {% if sameTagCount >= minCommonTags %}
        {% include book.html %}
      {% endif %}
    {% endfor %}
    <header>
      <h4>More great books {{ page.tags | join: '</strong> & <strong>' | prepend: 'by <strong>' }}</strong></h4>
    </header>
    <footer>
      <p>We’ve only read this book {{ page.tags | join: '</span> & <span class="book--author book--author--actual">' | prepend: 'by <span class="book--author book--author--actual">' }}</span>.</p>
      <p>See <a href="{{ site.baseurl }}/">other books</a> we’ve read or <a href="mailto:{{ site.email }}?subject=You should read this book next…">suggest one</a> we haven’t.</p>
    </footer>
  </section>
</section>